%\usepackage[utf8]{inputenc}
%\tracinglostchars=3
\usepackage{amsmath, amsfonts, amssymb, bm}
\usepackage[dvipsnames]{xcolor}
\usepackage{verbatim,mathtools,graphicx}
\usepackage{tikz, tikz-cd}
\usepackage{enumitem,xparse,url}
\usepackage[most]{tcolorbox}
\usepackage{multirow,array}
\usepackage{hyperref,bookmark}
\usepackage{stmaryrd}
\usepackage{microtype}

% font stuff, taken from Kaobook, but with a different caligraphic font
\usepackage{unicode-math}
\setromanfont[
  Scale=1.04
]{Libertinus Serif}
\setsansfont[
  Scale=1
]{Libertinus Sans}
\setmonofont[
  Scale=.89
]{Liberation Mono}
\setmathfont{Libertinus Math}
\setmathfont{Euler Math}[range=cal]

% Renewed commands
\renewcommand{\injlim}{\varinjlim}
\renewcommand{\projlim}{\varprojlim}

% Column stuff
\newcolumntype{x}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}p{#1}}


% TikZ stuff
\newsavebox{\pullbacksq}
\sbox\pullbacksq{%
\begin{tikzpicture}%
\draw ({0ex},{0ex}) -- ({1ex},{0ex});%
\draw ({1ex},{0ex}) -- ({1ex},{1ex});%
\end{tikzpicture}}

\newsavebox{\pushoutsq}
\sbox\pushoutsq{%
\begin{tikzpicture}%
\draw (0,0) -- (0ex,1ex);%
\draw (0ex,1ex) -- (1ex,1ex);%
\end{tikzpicture}}

\tikzset{
    labl/.style={anchor=north, rotate=90},
    pullback/.style={commutative diagrams/phantom, "\usebox\pullbacksq" , very near start},
    pushout/.style={commutative diagrams/phantom, "\usebox\pushoutsq" , very near start},
    symbol/.style={%
      draw=none,
      every to/.append style={edge node={node [sloped, allow upside down, auto=false]{$#1$}}}
    }
}


% Environments
% warning box
\newenvironment{warningbox}{\begin{tcolorbox}[colback=red!5!white, colframe=red!80!black, title=\textbf{Warning!}]}{\end{tcolorbox}}
% note box
\newenvironment{notebox}{\begin{tcolorbox}[colback=blue!5!white, colframe=blue!80!black, title=\textbf{Note}]}{\end{tcolorbox}}
% todo box
\newenvironment{todobox}{\begin{tcolorbox}[colback=green!5!white, colframe=green!80!black, title=\textbf{TODO}]}{\end{tcolorbox}}
% tikzcd diagram
\newenvironment{diagram*}{\begin{center}\begin{tikzcd}}{\end{tikzcd}\end{center}}
\newenvironment{diagram}{\begin{equation}\begin{tikzcd}}{\end{tikzcd}\end{equation}\ignorespaces}

\newenvironment{graph*}{\vspace{0.1cm}\begin{center}\begin{tikzcd}[every arrow/.append style={dash,thick}]}{\end{tikzcd}\end{center}\vspace{0.1cm}}
\newenvironment{graph}{\begin{equation}\begin{tikzcd}[every arrow/.append style={dash,thick}]}{\end{tikzcd}\end{equation}\ignorespaces}


% Fancy theorem, proof, example, etc. environments.
\tcbuselibrary{theorems}
\tcbuselibrary{skins}
\tcbuselibrary{breakable}
\tcbuselibrary{vignette}

% styling
\tcbset{
  plategeneric/.style={
    enhanced, breakable,
    borderline west={2pt}{0pt}{white!75!black},
    colback=white,
    top=1.3pt,
    bottom=1.3pt,
    left=7pt,
    right=7pt,
    grow to left by=10pt,
    grow to right by=10pt,
    boxrule=0pt,
    sharp corners
  },
  plate/.style={
    plategeneric,
    frame hidden,
    beforeafter skip balanced=0.22\baselineskip plus 1pt,
    height fixed for=first and middle,
    lines before break=1,
    pad at break*=1.1mm,
    detach title,
    coltitle=black
  },
  fancythm/.style={
    plate,
    top=4pt,
    bottom=4pt,
    borderline west={2pt}{0pt}{Goldenrod!70!black},
    colback=Goldenrod!5!white,
    before upper={\parindent15pt\noindent\textup{\textbf{\tcbtitle.}}\,\,},
    fontupper=\itshape
  },
  fancyconj/.style={
    plate,
    borderline west={2pt}{0pt}{Goldenrod!80!black},
    %colback=Goldenrod!10!white,
    before upper={\parindent15pt\noindent\textup{\textbf{\tcbtitle.}}\,\,},
    fontupper=\itshape
  },
  fancyproof/.style={
    plate,
    borderline west={2pt}{0pt}{Peach!75!black},
    colback=Peach!1!white,
    fonttitle=\itshape,
    before upper={\parindent15pt\noindent\tcbtitle\textit{.}\,\,\,},
    fontupper=\upshape
  },
  fancydef/.style={
    plate,
    borderline west={2pt}{0pt}{NavyBlue!85!black},
    colback=white,
    fonttitle=\bfseries,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,}
  },
  fancynotation/.style={
    plate,
    borderline west={2pt}{0pt}{Cyan!65!black},
    colback=white,
    fonttitle=\bfseries,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,}
  },
  fancyexample/.style={
    plate,
    borderline west={2pt}{0pt}{Plum!75!black},
    colback=white,
    fonttitle=\bfseries,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,}
  },
  fancyremark/.style={
    plate,
    borderline west={2pt}{0pt}{Emerald!75!black},
    colback=white,
    fonttitle=\itshape,
    before upper={\parindent15pt\noindent\tcbtitle\textit{.}\,\,\,}
  },
  fancyexercise/.style={
    plate,
    borderline west={2pt}{0pt}{WildStrawberry!85!black},
    colback=WildStrawberry!10!white,
    fonttitle=\bfseries,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,}
  },
  fancysoln/.style={
    plate,
    borderline west={2pt}{0pt}{YellowGreen!85!black},
    colback=white,
    fonttitle=\bfseries,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,}
  },
  fancywarning/.style={
    plate,
    borderline west={2pt}{0pt}{Red!75!black},
    colback=Red!15!white,
    before upper={\parindent15pt\noindent\tcbtitle\textbf{.}\,\,\,},
    fonttitle=\bfseries,
    fontupper=\upshape
  },
  fancynote/.style={
    plategeneric,
    grow to right by=4pt,
    borderline west={2pt}{0pt}{ProcessBlue!75!black},
    colback=ProcessBlue!15!white,
    colbacktitle=ProcessBlue!50!white,
    coltitle={ProcessBlue!30!black},
    title={Note},
    fonttitle=\bfseries,
    fontupper=\upshape,
    before upper={\parindent15pt\noindent}
  },
  fancytodo/.style={
    plategeneric,
    grow to right by=4pt,
    borderline west={2pt}{0pt}{Green!75!black},
    colback=Green!15!white,
    colbacktitle=Green!50!white,
    coltitle={Green!40!black},
    title={TO-DO},
    fonttitle=\bfseries,
    fontupper=\upshape,
    before upper={\parindent15pt\noindent}
  }
}

% Command for creating fancy theorem-like environments
% Creates the title format for some parts.
% args: display name, thesection, number (& added text for optional)
\newcommand{\ThmTitleNoOptional}[3]{#1 #2.#3}
\newcommand{\ThmTitleOptional}[4]{#1 #2.#3: #4}
% args: counter prefix (optional), name, display name, style, counter    \ThmTitleOptional{#3}{\thesection}{\arabic{#5}}{##1}
\NewDocumentCommand\goodnewtcbtheorem{ommmm}{%
  \IfNoValueTF{#1}{%
  \newenvironment{#2}[1][]{\refstepcounter{#5}\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{\ThmTitleNoOptional{#3}{\thesection}{\arabic{#5}}}\else{\ThmTitleOptional{#3}{\thesection}{\arabic{#5}}{##1}}\fi},#4]}{\end{tcolorbox}}%
  \newenvironment{#2*}[1][]{\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{#3}\else{#3: ##1}\fi},#4]}{\end{tcolorbox}}%
  }{%
  \newenvironment{#2}[1][]{\refstepcounter{#5}\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{#3 #1\arabic{#5}}\else{#3 #1\arabic{#5}: ##1}\fi},#4]}{\end{tcolorbox}}%
  \newenvironment{#2*}[1][]{\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{#3}\else{#3: ##1}\fi},#4]}{\end{tcolorbox}}%
  }
}
\NewDocumentCommand\goodrenewtcbtheorem{ommmm}{%
  \IfNoValueTF{#1}{%
  \renewenvironment{#2}[1][]{\refstepcounter{#5}\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{#3 \thesection.\arabic{#5}}\else{#3 \thesection.\arabic{#5}: ##1}\fi},#4]}{\end{tcolorbox}}%
  \renewenvironment{#2*}[1][]{\begin{tcolorbox}[title={\if{#3}\else{#3: ##1}\fi},#4]}{\end{tcolorbox}}%
  }{%
  \renewenvironment{#2}[1][]{\refstepcounter{#5}\begin{tcolorbox}[title={\if\relax\detokenize{##1}\relax{#3 #1\arabic{#5}}\else{#3 #1\arabic{#5}: ##1}\fi},#4]}{\end{tcolorbox}}%
  \renewenvironment{#2*}[1][]{\begin{tcolorbox}[title={\if{#3}\else{#3: ##1}\fi},#4]}{\end{tcolorbox}}%
  }
}

% Counters
\newcounter{thmcounter}
\numberwithin{thmcounter}{section}

\newcounter{excounter}
\newcounter{probcounter}
\newcounter{solcounter}
\newcounter{taskcounter}

% Theorems, Lemmas, etc.
% Theorem style
\goodnewtcbtheorem{theorem}{Theorem}{fancythm}{thmcounter}
\goodnewtcbtheorem{theoremdef}{Theorem-Definition}{fancythm}{thmcounter}
\goodnewtcbtheorem{proposition}{Proposition}{fancythm}{thmcounter}
\goodnewtcbtheorem{propositiondef}{Proposition-Definition}{fancythm}{thmcounter}
\goodnewtcbtheorem{corollary}{Corollary}{fancythm}{thmcounter}
\goodnewtcbtheorem{lemma}{Lemma}{fancythm}{thmcounter}
\goodnewtcbtheorem{fact}{Fact}{fancythm}{thmcounter}

\goodnewtcbtheorem{conjecture}{Conjecture}{fancyconj, fontupper=\upshape}{thmcounter}

\goodnewtcbtheorem{goal}{Goal}{fancyconj, fontupper=\upshape}{thmcounter}

% Definition style
\goodnewtcbtheorem{definition}{Definition}{fancydef}{thmcounter}

% Notation style
\goodnewtcbtheorem{notation}{Notation}{fancynotation}{thmcounter}
\goodnewtcbtheorem{terminology}{Terminology}{fancynotation}{thmcounter}
\goodnewtcbtheorem{convention}{Convention}{fancynotation}{thmcounter}
\goodnewtcbtheorem{question}{Question}{fancynotation}{thmcounter}
\goodnewtcbtheorem{axiom}{Axiom}{fancynotation}{thmcounter}

% Example style
\goodnewtcbtheorem{example}{Example}{fancyexample}{thmcounter}
\goodnewtcbtheorem{construction}{Construction}{fancyexample}{thmcounter}
\goodnewtcbtheorem{sketch}{Sketch}{fancyexample}{thmcounter}

% Remark style
\goodnewtcbtheorem{remark}{Remark}{fancyremark}{thmcounter}
\goodnewtcbtheorem{discussion}{Discussion}{fancyremark}{thmcounter}

% Exercise style, empty [] necessary.
\goodnewtcbtheorem[]{exercise}{Exercise}{fancyexercise}{excounter}
\goodnewtcbtheorem[]{task}{Task}{fancyexercise}{taskcounter}
\goodnewtcbtheorem[]{problem}{Problem}{fancyexercise}{probcounter}

% Solution style, empty [] necessary.
\goodnewtcbtheorem[]{solution}{Solution}{fancysoln}{solcounter}

% Warning style
\goodnewtcbtheorem{warning}{Warning}{fancywarning}{thmcounter}

% fancy note and todo
\newtcolorbox{note}{fancynote}
\newtcolorbox{todo}{fancytodo}

% Proof environment.
\newcommand{\qedsymbol}{$\blacksquare$}
\newtcolorbox{proof}[1][Proof]{fancyproof, title={#1}}
\AtEndEnvironment{proof}{\null\hfill\qedsymbol}
% "Proof Sketch" environment
\newenvironment{proofsketch}{\begin{proof}[Proof sketch]\renewcommand\qedsymbol{$\square$}}{\end{proof}\renewcommand\qedsymbol{$\blacksquare$}}

% QED symbol should be black tombstone.
\renewcommand\qedsymbol{$\blacksquare$}
\makeatletter
\newcommand{\oset}[3][0ex]{%
  \mathrel{\mathop{#3}\limits^{
    \vbox to#1{\kern-2\ex@
    \hbox{$\scriptstyle#2$}\vss}}}}
\makeatother

% utility "such that" command.
\newcommand{\st}{
  \text{ s.t. }
}

\newcommand{\bigmid}{\biggm|}
\newcommand{\ldsq}{\llbracket}
\newcommand{\rdsq}{\rrbracket}
\newcommand{\dashto}{\dashrightarrow}

\newcommand{\lcm}{\operatorname{lcm}}

% arrows
\newcommand{\longto}{\longrightarrow}
\newcommand{\ot}{\leftarrow}
\newcommand{\xto}{\xrightarrow}
\newcommand{\xot}{\xleftarrow}
\newcommand{\longot}{\longleftarrow}
\newcommand{\Longto}{\Longrightarrow}
\newcommand{\oT}{\Leftarrow}
\newcommand{\To}{\Rightarrow}
\newcommand{\longoT}{\Longleftarrow}

% useful
\newcommand{\fd}{\textup{f.d.}}
\newcommand{\ev}{\operatorname{ev}}

% mathbf
\newcommand{\bfA}{\ensuremath{\symbf{A}}}
\newcommand{\bfB}{\ensuremath{\symbf{B}}}
\newcommand{\bfC}{\ensuremath{\symbf{C}}}
\newcommand{\bfD}{\ensuremath{\symbf{D}}}
\newcommand{\bfE}{\ensuremath{\symbf{E}}}
\newcommand{\bfF}{\ensuremath{\symbf{F}}}
\newcommand{\bfG}{\ensuremath{\symbf{G}}}
\newcommand{\bfH}{\ensuremath{\symbf{H}}}
\newcommand{\bfI}{\ensuremath{\symbf{I}}}
\newcommand{\bfJ}{\ensuremath{\symbf{J}}}
\newcommand{\bfK}{\ensuremath{\symbf{K}}}
\newcommand{\bfL}{\ensuremath{\symbf{L}}}
\newcommand{\bfM}{\ensuremath{\symbf{M}}}
\newcommand{\bfN}{\ensuremath{\symbf{N}}}
\newcommand{\bfO}{\ensuremath{\symbf{O}}}
\newcommand{\bfP}{\ensuremath{\symbf{P}}}
\newcommand{\bfQ}{\ensuremath{\symbf{Q}}}
\newcommand{\bfR}{\ensuremath{\symbf{R}}}
\newcommand{\bfS}{\ensuremath{\symbf{S}}}
\newcommand{\bfT}{\ensuremath{\symbf{T}}}
\newcommand{\bfU}{\ensuremath{\symbf{U}}}
\newcommand{\bfV}{\ensuremath{\symbf{V}}}
\newcommand{\bfW}{\ensuremath{\symbf{W}}}
\newcommand{\bfX}{\ensuremath{\symbf{X}}}
\newcommand{\bfY}{\ensuremath{\symbf{Y}}}
\newcommand{\bfZ}{\ensuremath{\symbf{Z}}}
\newcommand{\bfDelta}{\ensuremath{\symbf{\Delta}}}

% mathsf
\newcommand{\sfA}{\ensuremath{\symsf{A}}}
\newcommand{\sfB}{\ensuremath{\symsf{B}}}
\newcommand{\sfC}{\ensuremath{\symsf{C}}}
\newcommand{\sfD}{\ensuremath{\symsf{D}}}
\newcommand{\sfE}{\ensuremath{\symsf{E}}}
\newcommand{\sfF}{\ensuremath{\symsf{F}}}
\newcommand{\sfG}{\ensuremath{\symsf{G}}}
\newcommand{\sfH}{\ensuremath{\symsf{H}}}
\newcommand{\sfI}{\ensuremath{\symsf{I}}}
\newcommand{\sfJ}{\ensuremath{\symsf{J}}}
\newcommand{\sfK}{\ensuremath{\symsf{K}}}
\newcommand{\sfL}{\ensuremath{\symsf{L}}}
\newcommand{\sfM}{\ensuremath{\symsf{M}}}
\newcommand{\sfN}{\ensuremath{\symsf{N}}}
\newcommand{\sfO}{\ensuremath{\symsf{O}}}
\newcommand{\sfP}{\ensuremath{\symsf{P}}}
\newcommand{\sfQ}{\ensuremath{\symsf{Q}}}
\newcommand{\sfR}{\ensuremath{\symsf{R}}}
\newcommand{\sfS}{\ensuremath{\symsf{S}}}
\newcommand{\sfT}{\ensuremath{\symsf{T}}}
\newcommand{\sfU}{\ensuremath{\symsf{U}}}
\newcommand{\sfV}{\ensuremath{\symsf{V}}}
\newcommand{\sfW}{\ensuremath{\symsf{W}}}
\newcommand{\sfX}{\ensuremath{\symsf{X}}}
\newcommand{\sfY}{\ensuremath{\symsf{Y}}}
\newcommand{\sfZ}{\ensuremath{\symsf{Z}}}

% mathbb
\newcommand{\bbA}{\ensuremath{\symbb{A}}}
\newcommand{\bbB}{\ensuremath{\symbb{B}}}
\newcommand{\bbC}{\ensuremath{\symbb{C}}}
\newcommand{\bbD}{\ensuremath{\symbb{D}}}
\newcommand{\bbE}{\ensuremath{\symbb{E}}}
\newcommand{\bbF}{\ensuremath{\symbb{F}}}
\newcommand{\bbG}{\ensuremath{\symbb{G}}}
\newcommand{\bbH}{\ensuremath{\symbb{H}}}
\newcommand{\bbI}{\ensuremath{\symbb{I}}}
\newcommand{\bbJ}{\ensuremath{\symbb{J}}}
\newcommand{\bbK}{\ensuremath{\symbb{K}}}
\newcommand{\bbL}{\ensuremath{\symbb{L}}}
\newcommand{\bbM}{\ensuremath{\symbb{M}}}
\newcommand{\bbN}{\ensuremath{\symbb{N}}}
\newcommand{\bbO}{\ensuremath{\symbb{O}}}
\newcommand{\bbP}{\ensuremath{\symbb{P}}}
\newcommand{\bbQ}{\ensuremath{\symbb{Q}}}
\newcommand{\bbR}{\ensuremath{\symbb{R}}}
\newcommand{\bbS}{\ensuremath{\symbb{S}}}
\newcommand{\bbT}{\ensuremath{\symbb{T}}}
\newcommand{\bbU}{\ensuremath{\symbb{U}}}
\newcommand{\bbV}{\ensuremath{\symbb{V}}}
\newcommand{\bbW}{\ensuremath{\symbb{W}}}
\newcommand{\bbX}{\ensuremath{\symbb{X}}}
\newcommand{\bbY}{\ensuremath{\symbb{Y}}}
\newcommand{\bbZ}{\ensuremath{\symbb{Z}}}

% mathcal
\newcommand{\calA}{\ensuremath{\symcal{A}}}
\newcommand{\calB}{\ensuremath{\symcal{B}}}
\newcommand{\calC}{\ensuremath{\symcal{C}}}
\newcommand{\calD}{\ensuremath{\symcal{D}}}
\newcommand{\calE}{\ensuremath{\symcal{E}}}
\newcommand{\calF}{\ensuremath{\symcal{F}}}
\newcommand{\calG}{\ensuremath{\symcal{G}}}
\newcommand{\calH}{\ensuremath{\symcal{H}}}
\newcommand{\calI}{\ensuremath{\symcal{I}}}
\newcommand{\calJ}{\ensuremath{\symcal{J}}}
\newcommand{\calK}{\ensuremath{\symcal{K}}}
\newcommand{\calL}{\ensuremath{\symcal{L}}}
\newcommand{\calM}{\ensuremath{\symcal{M}}}
\newcommand{\calN}{\ensuremath{\symcal{N}}}
\newcommand{\calO}{\ensuremath{\symcal{O}}}
\newcommand{\calP}{\ensuremath{\symcal{P}}}
\newcommand{\calQ}{\ensuremath{\symcal{Q}}}
\newcommand{\calR}{\ensuremath{\symcal{R}}}
\newcommand{\calS}{\ensuremath{\symcal{S}}}
\newcommand{\calT}{\ensuremath{\symcal{T}}}
\newcommand{\calU}{\ensuremath{\symcal{U}}}
\newcommand{\calV}{\ensuremath{\symcal{V}}}
\newcommand{\calW}{\ensuremath{\symcal{W}}}
\newcommand{\calX}{\ensuremath{\symcal{X}}}
\newcommand{\calY}{\ensuremath{\symcal{Y}}}
\newcommand{\calZ}{\ensuremath{\symcal{Z}}}

% mathscr
\newcommand{\scrA}{\ensuremath{\symscr{A}}}
\newcommand{\scrB}{\ensuremath{\symscr{B}}}
\newcommand{\scrC}{\ensuremath{\symscr{C}}}
\newcommand{\scrD}{\ensuremath{\symscr{D}}}
\newcommand{\scrE}{\ensuremath{\symscr{E}}}
\newcommand{\scrF}{\ensuremath{\symscr{F}}}
\newcommand{\scrG}{\ensuremath{\symscr{G}}}
\newcommand{\scrH}{\ensuremath{\symscr{H}}}
\newcommand{\scrI}{\ensuremath{\symscr{I}}}
\newcommand{\scrJ}{\ensuremath{\symscr{J}}}
\newcommand{\scrK}{\ensuremath{\symscr{K}}}
\newcommand{\scrL}{\ensuremath{\symscr{L}}}
\newcommand{\scrM}{\ensuremath{\symscr{M}}}
\newcommand{\scrN}{\ensuremath{\symscr{N}}}
\newcommand{\scrO}{\ensuremath{\symscr{O}}}
\newcommand{\scrP}{\ensuremath{\symscr{P}}}
\newcommand{\scrQ}{\ensuremath{\symscr{Q}}}
\newcommand{\scrR}{\ensuremath{\symscr{R}}}
\newcommand{\scrS}{\ensuremath{\symscr{S}}}
\newcommand{\scrT}{\ensuremath{\symscr{T}}}
\newcommand{\scrU}{\ensuremath{\symscr{U}}}
\newcommand{\scrV}{\ensuremath{\symscr{V}}}
\newcommand{\scrW}{\ensuremath{\symscr{W}}}
\newcommand{\scrX}{\ensuremath{\symscr{X}}}
\newcommand{\scrY}{\ensuremath{\symscr{Y}}}
\newcommand{\scrZ}{\ensuremath{\symscr{Z}}}

% mathfrak
\newcommand{\frakA}{\ensuremath{\symfrak{A}}}
\newcommand{\frakB}{\ensuremath{\symfrak{B}}}
\newcommand{\frakC}{\ensuremath{\symfrak{C}}}
\newcommand{\frakD}{\ensuremath{\symfrak{D}}}
\newcommand{\frakE}{\ensuremath{\symfrak{E}}}
\newcommand{\frakF}{\ensuremath{\symfrak{F}}}
\newcommand{\frakG}{\ensuremath{\symfrak{G}}}
\newcommand{\frakH}{\ensuremath{\symfrak{H}}}
\newcommand{\frakI}{\ensuremath{\symfrak{I}}}
\newcommand{\frakJ}{\ensuremath{\symfrak{J}}}
\newcommand{\frakK}{\ensuremath{\symfrak{K}}}
\newcommand{\frakL}{\ensuremath{\symfrak{L}}}
\newcommand{\frakM}{\ensuremath{\symfrak{M}}}
\newcommand{\frakN}{\ensuremath{\symfrak{N}}}
\newcommand{\frakO}{\ensuremath{\symfrak{O}}}
\newcommand{\frakP}{\ensuremath{\symfrak{P}}}
\newcommand{\frakQ}{\ensuremath{\symfrak{Q}}}
\newcommand{\frakR}{\ensuremath{\symfrak{R}}}
\newcommand{\frakS}{\ensuremath{\symfrak{S}}}
\newcommand{\frakT}{\ensuremath{\symfrak{T}}}
\newcommand{\frakU}{\ensuremath{\symfrak{U}}}
\newcommand{\frakV}{\ensuremath{\symfrak{V}}}
\newcommand{\frakW}{\ensuremath{\symfrak{W}}}
\newcommand{\frakX}{\ensuremath{\symfrak{X}}}
\newcommand{\frakY}{\ensuremath{\symfrak{Y}}}
\newcommand{\frakZ}{\ensuremath{\symfrak{Z}}}


% Calculus, transforms, and other stuff
\newcommand*{\diff}{\mathop{}\!\mathrm{d}}
\newcommand{\Res}{\operatorname{Res}}
\newcommand{\p}{\partial}
\newcommand{\diam}{\mathrm{diam}\,}
\renewcommand{\Im}{\operatorname{Im}}
\renewcommand{\Re}{\operatorname{Re}}
\newcommand{\sinc}{\mathrm{sinc}}

% Common Sets
\newcommand{\Z}{\symbb{Z}}
\newcommand{\Q}{\symbb{Q}}
\newcommand{\R}{\symbb{R}}
\newcommand{\C}{\symbb{C}}
\newcommand{\D}{\symbb{D}}
\newcommand{\N}{\symbb{N}}
\newcommand{\E}{\symbb{E}}
\newcommand{\F}{\symbb{F}}
\newcommand{\G}{\symbb{G}}
\newcommand{\A}{\symbb{A}}
\newcommand{\TT}{\symbb{T}}
\newcommand{\PP}{\symbb{P}}
\newcommand{\pow}{
  \symcal{P}
}

% Algebra
\newcommand{\adj}{\operatorname{adj}}
\newcommand{\ind}{\operatorname{ind}}
\newcommand{\height}{\operatorname{ht}}
\newcommand{\dual}{\vee}
\newcommand{\sep}{\text{sep}}
\newcommand{\nor}{\text{nor}}
\newcommand{\red}{\mathrm{red}}
\newcommand{\gal}{\text{gal}}
\newcommand{\ideal}{\symfrak}
\newcommand{\GL}{\operatorname{GL}}
\newcommand{\SL}{\operatorname{SL}}
\newcommand{\M}{\operatorname{M}}
\newcommand{\nrmleq}{\trianglelefteq}
\newcommand{\nrmgeq}{\trianglerighteq}
\newcommand{\cyclic}[1]{\langle #1 \rangle}
\newcommand{\coimg}{\operatorname{coim}}
\newcommand{\img}{\operatorname{im}}
\newcommand{\Frac}{\operatorname{Frac}}
\newcommand{\aut}{\operatorname{Aut}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\End}{\operatorname{End}}
\newcommand{\Ann}{\operatorname{Ann}}
\newcommand{\Gal}{\operatorname{Gal}}
\newcommand{\Tor}{\operatorname{Tor}}
\newcommand{\coker}{\operatorname{coker}}
\newcommand{\eq}{\operatorname{eq}}
\newcommand{\coeq}{\operatorname{coeq}}
\newcommand{\spec}{\operatorname{Spec}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\Proj}{\operatorname{Proj}}
\newcommand{\Ox}{\symcal{O}}
\newcommand{\Open}{\operatorname{Open}}
\newcommand{\Char}{\operatorname{char}}
\newcommand{\Span}{\operatorname{Span}}
\newcommand{\intO}{\symscr{O}}
\newcommand{\Pic}{\operatorname{Pic}}
\newcommand{\Ext}{\operatorname{Ext}}
\newcommand{\KProj}{\operatorname{KProj}}


\newcommand{\hooktwoheadrightarrow}{\hookrightarrow\mathrel{\mspace{-15mu}}\rightarrow}
\makeatletter
\newcommand{\xhooktwoheadrightarrow}[2][]{%
  \lhook\joinrel
  \ext@arrow 0359\rightarrowfill@ {#1}{#2}%
  \mathrel{\mspace{-15mu}}\rightarrow
}
\makeatother
\newcommand{\iso}{\xrightarrow{\sim}}
\newcommand{\isom}{\hooktwoheadrightarrow}
\newcommand{\inj}{\hookrightarrow}
\newcommand{\sur}{\twoheadrightarrow}
\newcommand{\orbits}{\mathrm{O}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\nullity}{\operatorname{nullity}}
\newcommand{\tr}{\operatorname{tr}}

% Geometry
\newcommand{\simh}{\sim_\textup{h}}
\newcommand{\Supp}{\operatorname{Supp}}
\newcommand{\spa}{\operatorname{sp}}
\newcommand{\HH}{\operatorname{H}}
\newcommand{\hh}{\operatorname{h}}
\newcommand{\mult}{\operatorname{mult}}
\newcommand{\codim}{\operatorname{codim}}
\newcommand{\Sp}{\mathrm{Sp}}
\newcommand{\Sk}{\operatorname{Sk}}
\newcommand{\Sing}{\operatorname{Sing}}
\newcommand{\ho}{\operatorname{ho}}

% Category Theory
\newcommand{\Qis}{\operatorname{Qis}}
\newcommand{\thick}{\operatorname{thick}}
\newcommand{\Lan}{\operatorname{Lan}}
\newcommand{\Ran}{\operatorname{Ran}}
\newcommand{\Com}{\operatorname{Com}}
\newcommand{\Ind}{\operatorname{Ind}}
\newcommand{\Pro}{\operatorname{Pro}}
\newcommand{\pre}{\mathrm{pre}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Map}{\operatorname{Map}}
\newcommand{\iHom}{\underline{\Hom}}
\newcommand{\SHom}{\symcal{H}\hspace{-0.0833em}om}
\newcommand{\Mor}{\operatorname{Mor}}
\newcommand{\Fun}{\operatorname{Fun}}
\newcommand{\Nat}{\operatorname{Nat}}
\newcommand{\Der}{\operatorname{Der}}
\newcommand{\hocolim}{\operatorname{hocolim}}
\newcommand{\sheaf}{\symscr}
\newcommand{\sh}{\text{sh}}
\newcommand{\cat}{\symbf}
\newcommand{\natcat}[1]{ \symbf{[#1]} }
\newcommand{\dom}{\operatorname{dom}}
\newcommand{\cod}{\operatorname{cod}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\Cones}{\operatorname{Cones}}
\newcommand{\ob}{\operatorname{Ob}}
\newcommand{\Ob}{\ob}
\newcommand{\Ar}{\operatorname{Ar}}
\newcommand{\natto}{%
  \mathrel{\vbox{\offinterlineskip
    \mathsurround=0pt
    \ialign{\hfil##\hfil\cr
      \normalfont\scalebox{1.2}{.}\cr
%      \noalign{\kern-.05ex}
      $\rightarrow$\cr}
  }}%
}

% Some Categories
\newcommand{\Cat}{\cat{Cat}}
\newcommand{\inftyCat}{\infty\text{-}\cat{Cat}}
\newcommand{\Set}{\cat{Set}}
\newcommand{\PSet}{\cat{Set_*}}
\newcommand{\Ens}[1]{\cat{Ens}_{#1}}
\newcommand{\Mon}{\cat{Mon}}
\newcommand{\CMon}{\cat{CMon}}
\newcommand{\Grp}{\cat{Grp}}
\newcommand{\Gpd}{\cat{Gpd}}
\newcommand{\Ab}{\cat{Ab}}
\newcommand{\Rng}{\cat{Rng}}
\newcommand{\CRng}{\cat{CRng}}
\newcommand{\Mod}{\cat{Mod}}
\newcommand{\Alg}{\cat{Alg}}
\newcommand{\Rep}{\cat{Rep}}
\newcommand{\RMod}[1][R]{#1\text{-}\cat{Mod}}
\newcommand{\ModR}[1][R]{\cat{Mod}\text{-}#1}
\newcommand{\RAlg}[1][R]{#1\text{-}\cat{Alg}}
\newcommand{\Top}{\cat{Top}}
%\@ifundefined{Top}{\newcommand{\Top}{\cat{Top}}}{\renewcommand{\Top}{\cat{Top}}}
\newcommand{\SMan}{\cat{SMan}}
\newcommand{\SmMan}{\cat{SmMan}}
\newcommand{\Sm}{\cat{Sm}}
\newcommand{\PTop}{\cat{Top_*}}
\newcommand{\hTop}{\cat{hTop}}
\newcommand{\Vect}{\cat{Vect}}
\newcommand{\PShf}{\operatorname{\cat{PShf}}}
\newcommand{\Shf}{\operatorname{\cat{Shf}}}
\newcommand{\PSh}{\operatorname{\cat{PSh}}}
\newcommand{\Sh}{\operatorname{\cat{Sh}}}
\newcommand{\RSp}{\cat{RSp}}
\newcommand{\Sch}{\cat{Sch}}
\newcommand{\AffSch}{\cat{AffSch}}
\newcommand{\sSet}{\cat{sSet}}
\newcommand{\Ch}{\cat{Ch}}
